<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Region</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
           google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawAllSheets);
      function drawAllSheets() {
        drawSheetName('MENA', 'SELECT A, D', 
            menaResponseHandler);
        drawSheetName('MENA', 'SELECT A, F', 
            menaecoResponseHandler);
        drawSheetName('MENA', 'SELECT A, G', 
            menafamilyResponseHandler);     
        drawSheetName('MENA', 'SELECT A, H', 
            menahealthResponseHandler);
        drawSheetName('MENA', 'SELECT A, I',
            menafreeResponseHandler);
        drawSheetName('MENA', 'SELECT A, J', 
            menatrustResponseHandler);
        drawSheetName('MENA', 'SELECT A, K', 
            menageneResponseHandler);
        };

      function drawSheetName(sheetName, query, responseHandler){
        var queryString = encodeURIComponent(query);
        var query = new google.visualization.Query("https://docs.google.com/spreadsheets/d/1o9AeiL9ip_xrXrLtA-x2QM3RZHhT1mRJ6ILdnXhjAx0/gviz/tq?sheet="+ sheetName + "&headers=1&tq=" + queryString);
        query.send(responseHandler);
        };

      function menaResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:1, desc:true});

          var options = {height:400,
                          vAxis:{title:'Happiness Score'},
                          hAxis:{title:'Country'},
                          colorAxis: {colors: ['yellow', 'red']}
                        };

          var chart = new google.visualization.GeoChart(document.getElementById("menarank_div"));

          chart.draw(data,options);

        }

      function menaecoResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Economy'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menaeco_div"));

          chart.draw(data,options);
        }

      function menafamilyResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Family'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menafamily_div"));

          chart.draw(data,options);
        }

      function menahealthResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Health'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menahealth_div"));

          chart.draw(data,options);
        }
      
      function menafreeResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Freedom'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menafree_div"));

          chart.draw(data,options);
        }
      
      function menatrustResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Trust'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menatrust_div"));

          chart.draw(data,options);
        }

      function menageneResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Generosity'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("menagene_div"));

          chart.draw(data,options);
        }

      
    </script>
</head>
<body>
    <div id="main">
        <div id="header">
            <div id="logo">
              <div class="transbox">
                <h1><strong><center> The World Happniess Report </center></strong></h1>
              </div>
            </div>
            <div id="menubar">
                <ul id="menu">
                  <li><a href="index.html"><i class="fa fa-home"></i>Home</a></li>
                  <li><a href="world_rank.html"><i class="fa fa-globe"></i> World Rank</a></li>
                  <li class="selected"><a href="region.html"><i class="fa fa-map-marker"></i> Region Rank</a></li>
                  <li><a href="average.html"><i class="fa fa-bar-chart"></i> Average</a></li>
                  <li><a href="interesting.html"><i class="fa fa-pie-chart"></i> Other Info</a></li>
                </ul><!-- menu -->
            </div><!-- menubar -->
        </div><!-- header-->
        <div id="content">
        <div class="services container">
            <div class="custom-select" style="width:200px;">
                <select onChange="window.location.href=this.value">
                  <option value="region5.html">Middle East and Northern Africa</option>
                  <option value="region.html">Australia and New Zealand</option>
                  <option value="region2.html">Central and Eastern Europe</option>
                  <option value="region3.html">Eastern Asia</option>
                  <option value="region4.html">Latin America and Caribbean</option>
                  <option value="region6.html">North America</option>
                  <option value="region7.html">Southeastern Asia</option>
                  <option value="region8.html">Southern Asia</option>
                  <option value="region9.html">Sub-Saharan Africa</option>
                  <option value="region10.html">Western Europe</option>
                </select>
              </div>
            <h1><i class="fa fa-map-pin" aria-hidden="true"></i> Middle East and Northern Africa</h1>
            <button class="accordion">Analysis</button>
            <div class="panel">
              <p>
                Both Northern Africa and Sub-Saharan Africa has low happiness score, but Middle East has one top 20 highest happiness score 7.278, 
                which is Israel. However, Syria has the lowest score 3.006. As we know, Syria has been unstable for long time. 
                Before 2015, Syria unemployment rate and food price inflation rate kept increasing. 
                With the other various reason, dissatisfaction of citizen keeps rising and causes the civil war. 
                Therefore, Syriaâ€™s happiness score is the bottom 3.
            </div>
            <h2>Happiness Score</h2>
            <div id = "menarank_div" style="width:850px; height:500px"></div>
            <h2>Economy</h2>
            <div id = "menaeco_div" style="width:850px; height:500px"></div>
            <h2>Family</h2>
            <div id = "menafamily_div" style="width:850px; height:500px"></div>
            <h2>Health</h2>
            <div id = "menahealth_div" style="width:850px; height:500px"></div>
            <h2>Freedom</h2>
            <div id = "menafree_div" style="width:850px; height:500px"></div>
            <h2>Trust</h2>
            <div id = "menatrust_div" style="width:850px; height:500px"></div>
            <h2>Generosity</h2>
            <div id = "menagene_div" style="width:850px; height:500px"></div>

        </div><!-- services_container -->
      </div>
        <div id="footer">   
            Copyright&copy;
            <script>
                var d= new Date();
                document.write(d.getFullYear());
            </script>
            | <a href="https://www.linkedin.com/in/chengzeng92/">Linkedin</a>
            | <a href="mailto:czeng@gwmail.gwu.com">Contact US</a>
            | Create by- Cheng Zeng (Jane)
        </div><!-- footer -->
    </div><!-- main -->
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/script.js"></script>
<script>
  var acc = document.getElementsByClassName("accordion");
  var i;
  
  for (i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      if (panel.style.maxHeight) {
        panel.style.maxHeight = null;
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
      } 
    });
  }
  </script>
</body>
</html>