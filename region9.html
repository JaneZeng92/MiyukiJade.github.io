<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Region</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
           google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawAllSheets);
      function drawAllSheets() {
        drawSheetName('SSA', 'SELECT A, D', 
            SSAResponseHandler);
        drawSheetName('SSA', 'SELECT A, F', 
            SSAecoResponseHandler);
        drawSheetName('SSA', 'SELECT A, G', 
            SSAfamilyResponseHandler);     
        drawSheetName('SSA', 'SELECT A, H', 
            SSAhealthResponseHandler);
        drawSheetName('SSA', 'SELECT A, I',
            SSAfreeResponseHandler);
        drawSheetName('SSA', 'SELECT A, J', 
            SSAtrustResponseHandler);
        drawSheetName('SSA', 'SELECT A, K', 
            SSAgeneResponseHandler);
        };

      function drawSheetName(sheetName, query, responseHandler){
        var queryString = encodeURIComponent(query);
        var query = new google.visualization.Query("https://docs.google.com/spreadsheets/d/1o9AeiL9ip_xrXrLtA-x2QM3RZHhT1mRJ6ILdnXhjAx0/gviz/tq?sheet="+ sheetName + "&headers=1&tq=" + queryString);
        query.send(responseHandler);
        };

      function SSAResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          region: '002',
                          vAxis:{title:'Happiness Score'},
                          hAxis:{title:'Country'},
                          colorAxis: {colors: ['gainsboro', 'darkslategray']}
                        };

          var chart = new google.visualization.GeoChart(document.getElementById("SSArank_div"));

          chart.draw(data,options);

        }

      function SSAecoResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Economy'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAeco_div"));

          chart.draw(data,options);
        }

      function SSAfamilyResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Family'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAfamily_div"));

          chart.draw(data,options);
        }

      function SSAhealthResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Health'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAhealth_div"));

          chart.draw(data,options);
        }
      
      function SSAfreeResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Freedom'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAfree_div"));

          chart.draw(data,options);
        }
      
      function SSAtrustResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Trust'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAtrust_div"));

          chart.draw(data,options);
        }

      function SSAgeneResponseHandler(response){
          var data = response.getDataTable();
          data.sort({column:0, desc:true});

          var options = {height:400,
                          vAxis:{title:'Generosity'},
                          hAxis:{title:'Country'},
                        };

          var chart = new google.visualization.ColumnChart(document.getElementById("SSAgene_div"));

          chart.draw(data,options);
        }

      
    </script>
</head>
<body>
    <div id="main">
        <div id="header">
            <div id="logo">
              <div class="transbox">
                <h1><strong><center> The World Happniess Report </center></strong></h1>
              </div>
            </div>
            <div id="menubar">
                <ul id="menu">
                  <li><a href="index.html"><i class="fa fa-home"></i>Home</a></li>
                  <li><a href="world_rank.html"><i class="fa fa-globe"></i> World Rank</a></li>
                  <li class="selected"><a href="region.html"><i class="fa fa-map-marker"></i> Region Rank</a></li>
                  <li><a href="average.html"><i class="fa fa-bar-chart"></i> Average</a></li>
                  <li><a href="interesting.html"><i class="fa fa-pie-chart"></i> Other Info</a></li>
                </ul><!-- menu -->
            </div><!-- menubar -->
        </div><!-- header-->
        <div id="content">
        <div class="services container">
            <div class="custom-select" style="width:200px;">
                <select onChange="window.location.href=this.value">
                  <option value="region9.html">Sub-Saharan Africa</option>
                  <option value="region.html">Australia and New Zealand</option>
                  <option value="region2.html">Central and Eastern Europe</option>
                  <option value="region3.html">Eastern Asia</option>
                  <option value="region4.html">Latin America and Caribbean</option>
                  <option value="region5.html">Middle East and Northern Africa</option>
                  <option value="region6.html">North America</option>
                  <option value="region7.html">Southeastern Asia</option>
                  <option value="region8.html">Southern Asia</option>
                  <option value="region10.html">Western Europe</option>
                </select>
              </div>
            <h1><i class="fa fa-map-pin" aria-hidden="true"></i> Sub-Saharan Africa</h1>
            <button class="accordion">Analysis</button>
            <div class="panel">
              <p>
                As we mention before that Sub-Saharan Africa that has low happiness score at average. 
                Togo and Burundi are the bottom 2. A <a href="https://www.africanews.com/2017/03/21/why-africa-is-less-happy-than-the-rest-of-the-world//"> report</a> 
                shows that “Africa’s lower levels of happiness compared to other countries in the world might be attributed to the disappointment with different aspects of development under democracy, 
                although most citizens still believe that democracy is the best political system, they are critical of good governance in their countries.”
                </p>
            </div>
            <h2>Happiness Score</h2>
            <div id = "SSArank_div" style="width:850px; height:500px"></div>
            <h2>Economy</h2>
            <div id = "SSAeco_div" style="width:850px; height:500px"></div>
            <h2>Family</h2>
            <div id = "SSAfamily_div" style="width:850px; height:500px"></div>
            <h2>Health</h2>
            <div id = "SSAhealth_div" style="width:850px; height:500px"></div>
            <h2>Freedom</h2>
            <div id = "SSAfree_div" style="width:850px; height:500px"></div>
            <h2>Trust</h2>
            <div id = "SSAtrust_div" style="width:850px; height:500px"></div>
            <h2>Generosity</h2>
            <div id = "SSAgene_div" style="width:850px; height:500px"></div>

        </div><!-- services_container -->
      </div>
        <div id="footer">   
            Copyright&copy;
            <script>
                var d= new Date();
                document.write(d.getFullYear());
            </script>
            | <a href="https://www.linkedin.com/in/chengzeng92/">Linkedin</a>
            | <a href="mailto:czeng@gwmail.gwu.com">Contact US</a>
            | Create by- Cheng Zeng (Jane)
        </div><!-- footer -->
    </div><!-- main -->
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/script.js"></script>
<script>
  var acc = document.getElementsByClassName("accordion");
  var i;
  
  for (i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      if (panel.style.maxHeight) {
        panel.style.maxHeight = null;
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
      } 
    });
  }
  </script>
</body>
</html>